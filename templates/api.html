<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>API Handbook ‚Äî MoodWeather</title>
  <link rel="stylesheet" href="/static/styles.css" />
  <link rel="stylesheet" href="/static/api.css" />
</head>
<body>
  <div class="page-bg" aria-hidden="true"></div>

  <div class="shell">
    <header class="glass-nav">
      <div class="brand">
        <div class="brand-icon" aria-hidden="true">üåßÔ∏è</div>
        <div class="brand-title">MoodWeather</div>
      </div>

      <nav class="nav-links" aria-label="Primary">
        <a href="/" class="nav-link">Home</a>
        <a href="/#about" class="nav-link">About Project</a>
        <a href="/api" class="nav-link active" rel="documentation">API Docs</a>
      </nav>
    </header>

    <main class="glass-main">
      <div class="page">
        <header class="topbar">
          <h1>MoodWeather ‚Äî API Handbook</h1>
          <nav class="links" aria-label="Documentation links">
            <a href="/" class="pill">‚Üê Back</a>
            <a href="/docs" class="pill">Swagger</a>
            <a href="/openapi.json" class="pill">OpenAPI</a>
          </nav>
        </header>

        <section class="card">
          <h2>Overview</h2>
          <p class="muted">
            MoodWeather is a web service that recommends music based on current weather conditions.
            The system consists of a frontend (web client) and a backend API built with FastAPI.
          </p>
          <p class="muted">
            The frontend talks only to our own API. All logic for weather interpretation,
            mood analysis, and music selection happens on the server.
          </p>
        </section>

        <section class="card">
          <h2>What counts as an API in this project?</h2>
          <ul class="muted">
            <li><strong>Our API (Backend):</strong> FastAPI endpoints under <code>/api/</code></li>
            <li><strong>External APIs:</strong> OpenWeather (weather data) and Audius (music)</li>
            <li><strong>Browser API:</strong> Geolocation via <code>navigator.geolocation</code></li>
          </ul>
          <p class="muted">
            Location detection happens in the browser, but coordinates are sent to our backend API,
            which then fetches weather data and generates the recommendation.
          </p>
        </section>

        <section class="card">
          <h2>API design ‚Äî thinking and architecture</h2>
          <ul class="muted">
            <li>The frontend should stay simple and not contain business logic</li>
            <li>All API keys are stored server-side (<code>.env</code>)</li>
            <li>We return the same response format whether location is manual or automatic</li>
            <li>Recommendations should be explainable (<code>weather ‚Üí mood ‚Üí keywords</code>)</li>
          </ul>
        </section>

        <section class="card">
          <h2>How the recommendation works</h2>
          <ol class="muted">
            <li>The user provides a location (city or geolocation)</li>
            <li>The backend fetches current weather from OpenWeather</li>
            <li>Weather is analyzed (temperature, clouds, day/night, wind, precipitation)</li>
            <li>A music profile is calculated (e.g. energy and valence)</li>
            <li>The profile is translated into keywords</li>
            <li>The backend searches playlists via the Audius API</li>
            <li>The best matching playlist is returned to the frontend</li>
          </ol>
        </section>

        <section class="card">
          <h2>Endpoints ‚Äî our API</h2>

          <div class="endpoint">
            <div class="sig">
              <span class="method">GET</span>
              <span class="path">/api/recommend?location=&lt;city&gt;</span>
            </div>
            <p class="muted">Use this when the user manually enters a city.</p>
            <pre class="code">/api/recommend?location=London</pre>
          </div>

          <div class="endpoint">
            <div class="sig">
              <span class="method">GET</span>
              <span class="path">/api/recommend/coords?lat=&lt;float&gt;&amp;lon=&lt;float&gt;</span>
            </div>
            <p class="muted">Use this together with browser location detection.</p>
            <pre class="code">/api/recommend/coords?lat=55.6053&lon=13.0002</pre>
          </div>

          <div class="endpoint">
            <div class="sig">
              <span class="method">GET</span>
              <span class="path">/api/music/playlist/{playlist_id}/tracks</span>
            </div>
            <p class="muted">Returns tracks + stream URL for HTML5 audio playback.</p>
          </div>
        </section>

        <section class="card">
          <h2>Error handling</h2>
          <ul class="muted">
            <li><strong>200 OK</strong> ‚Äî success</li>
            <li><strong>404</strong> ‚Äî location or playlist not found</li>
            <li><strong>500</strong> ‚Äî server misconfiguration (e.g. missing API key)</li>
            <li><strong>502</strong> ‚Äî external API failure / invalid response</li>
          </ul>
        </section>

        <section class="card">
          <h2>Interactive API documentation</h2>
          <p class="muted">
            For detailed and always up-to-date documentation, we use FastAPI‚Äôs automatically generated Swagger UI.
          </p>
          <ul class="muted">
            <li><a href="/docs">/docs (Swagger UI)</a></li>
            <li><a href="/openapi.json">/openapi.json</a></li>
          </ul>
        </section>
      </div>
    </main>

    <footer class="app-footer">
      This web application is developed by a group of students at Malm√∂ University
    </footer>
  </div>
</body>
</html>